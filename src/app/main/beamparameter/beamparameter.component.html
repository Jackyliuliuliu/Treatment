<nz-spin class="load" *ngIf="BeamInfoLoading" nzSimple [nzSize]="'large'">
</nz-spin>


<div *ngIf="!BeamInfoLoading" class="beamgroup-view FlexRow">
  <ng-template #templateS let-node>
    <i class="ant-select-arrow-icon">
      <svg width="18px" height="18px" viewBox="0 0 18 18">
        <g id="icon/jiantou" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <rect id="Rectangle" fill-rule="nonzero" x="0" y="0" width="18" height="18"></rect>
          <polygon id="icon/drop" fill="#DCE0F2"
            transform="translate(8.781000, 9.500000) rotate(-90.000000) translate(-8.781000, -9.500000) "
            points="11.562 6.062 8.106 9.5 11.562 12.938 10.5 14 6 9.5 10.5 5"></polygon>
        </g>
      </svg>
    </i>
  </ng-template>
  <div class="top-content FlexRow Fill">
    <div class="ul-box FlexRow Fill">
      <div class="common-info-li">
        <div class="common-info-container FlexCol">
          <div class="info-col-item Fill">
            <nz-collapse [nzBordered]="false">
              <nz-collapse-panel nzHeader="{{l('Basic Info')}}" [nzActive]="true">
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Beam Name')}}</label>
                    <div class="right-info Fill">{{this.beam?.name}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Technique Protocol')}}</label>
                    <div class="right-info Fill">{{this.beam?.beamType}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('radiation mode')}}</label>
                    <div class="right-info Fill">{{beamModeString}}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                    <div class="common-info-col FlexCol Fill">
                      <label class="left-label">{{l('Dose Rate Set(MU/min)')}}</label>
                      <div class="right-info Fill">{{beam?.doseRateSet}} </div>
                    </div>
                    <div class="common-info-col FlexCol Fill">
                      <label class="left-label">{{l('Beam Dose(cGy)')}}</label>
                      <div class="right-info Fill">{{this.beam?.beamDose}}</div>
                    </div>
                    <div class="common-info-col FlexCol Fill">
                      <label class="left-label">{{l('Total MU')}}</label>
                      <div class="right-info Fill">{{this.beam?.beamMu}}</div>
                    </div>
                  </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Tolerance')}}</label>
                    <div class="right-info Fill">{{this.beam?.rtToleranceTables?.toleranceTableLabel}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Beam description')}}</label>
                    <div class="right-info Fill">{{this.beam?.description}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                  </div>
                </div>
              </nz-collapse-panel>
            </nz-collapse>
          </div>
          <div class="info-col-item Fill">
            <nz-collapse [nzBordered]="false">
              <nz-collapse-panel nzHeader="准直器信息" [nzActive]="true">
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">准直器角度(°)</label>
                    <div class="right-info Fill">{{ this.beam?.collimatorAngle }}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Cumulative MU')}}</label>
                    <div class="right-info Fill">{{cumulativeMu}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">SYMX</label>
                    <div class="right-info Fill">{{symx}}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">X jaw size(cm)</label>
                    <div class="right-info Fill">{{this.beam?.jawX2-this.beam?.jawX1}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">X1(cm)</label>
                    <div class="right-info Fill">{{ this.beam?.jawX1 }}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">X2(cm)</label>
                    <div class="right-info Fill">{{ this.beam?.jawX2 }}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">SYMY</label>
                    <div class="right-info Fill">{{symy}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">Y jaw size(cm)</label>
                    <div class="right-info Fill">{{this.beam?.jawY2-this.beam?.jawY1 }}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">Y1(cm)</label>
                    <div class="right-info Fill">{{ this.beam?.jawY1}}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">Y2(cm)</label>
                    <div class="right-info Fill">{{ this.beam?.jawY2}}</div>
                  </div>
                </div>
              </nz-collapse-panel>
            </nz-collapse>
          </div>
        </div>
      </div>
      <div class="common-info-li">
        <div class="common-info-container FlexCol">
          <div class="info-col-item Fill">
            <nz-collapse [nzBordered]="false">
              <nz-collapse-panel nzHeader="{{l('Gantry')}}" [nzActive]="true">
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Gantry angle(°)')}}</label>
                    <div class="right-info Fill">{{this.beam?.gantryAngle}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Arc Length(°)')}}</label>
                    <div class="right-info Fill">{{this.beam?.arcLength}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Gantry Stop Angle(°)')}}</label>
                    <div class="right-info Fill">{{this.beam?.arcStopGantryAngle}}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Gantry Rotation direction')}}</label>
                    <div class="right-info Fill">{{this.beam?.gantryRotationDirection?.name}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">SSD(cm)</label>
                    <div class="right-info Fill">{{SSD}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                      <label class="left-label">ISO Center </label>
                      <div class="right-info Fill">({{this.beam?.isocenter?.x.toFixed(2)}},{{this.beam?.isocenter?.y.toFixed(2)}},{{this.beam?.isocenter?.z.toFixed(2)}})</div>
                    </div>
                </div>
              </nz-collapse-panel>
            </nz-collapse>
            <nz-collapse [nzBordered]="false">
              <nz-collapse-panel nzHeader="治疗床信息" [nzActive]="true">
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">{{l('Patient Support Angle(°)')}}</label>
                    <div class="right-info Fill">{{this.beam?.patientSupportAngle}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">LAT(cm)</label>
                    <div class="right-info Fill">{{this.beam?.controlPoints[0]?.tableTopLateralPosition}}</div>
                  </div>
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">LNG(cm)</label>
                    <div class="right-info Fill">{{this.beam?.controlPoints[0]?.tableTopLongitudinalPosition}}</div>
                  </div>
                </div>
                <div class="common-info-row FlexCol">
                  <div class="common-info-col FlexCol Fill">
                    <label class="left-label">VRT(cm)</label>
                    <div class="right-info Fill">{{this.beam?.controlPoints[0]?.tableTopVerticalPosition}}</div>
                  </div>
                </div>
              </nz-collapse-panel>
            </nz-collapse>
          </div>
          <div class="info-col-item Fill">
            <nz-collapse [nzBordered]="false">
              <nz-collapse-panel nzHeader="BEV" [nzActive]="true">
                <mlc-component [controlPointsData]="controlPointsData" #mlcShape [id]="id"
                (GetControlPointIndex)="GetControlPointIndex($event)"></mlc-component>
                <div class="right-info Fill"></div>
              </nz-collapse-panel>
            </nz-collapse>
          </div>
        </div>
      </div>
      <div class="common-info-li" *ngIf="isImageAble">
        <nz-collapse [nzBordered]="false" >
          <nz-collapse-panel nzHeader="{{l('Imaging')}}" [nzActive]="true">
            <div class="common-info-row FlexCol">
              <div class="common-info-col FlexCol Fill">
                <label class="left-label">{{l('RT Image Position X(cm)')}}</label>
                <div class="right-info Fill">{{this.imagingPositionX}}</div>
              </div>
              <div class="common-info-col FlexCol Fill">
                <label class="left-label">{{l('RT Image Position Y(cm)')}}</label>
                <div class="right-info Fill">{{this.imagingPositionY}}</div>
              </div>
              <div class="common-info-col FlexCol Fill">
                <label class="left-label">{{l('RT Image SID(cm)')}}</label>
                <div class="right-info Fill">{{this.rtImagingSid}}</div>
              </div>
            </div>
            <label class="common-label-title" *ngIf="isImageAble && isPreAble">{{l('Protral Pre')}}</label>
            <div class="common-bg-container" *ngIf="isImageAble && isPreAble">
              <div class="common-info-row FlexCol">
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label fixed-width-label">MU</label>
                  <div class="right-info Fill">{{this.prePortalMu}}</div>
                </div>
              </div>
              <div class="common-info-row FlexCol">
                <div class="common-info-col FlexCol Fill">
                  <label class="form-label-checkbox" nz-checkbox [(nzChecked)]="this.prePortalDoubleExposure"  disabled>{{l('double exposure')}}</label>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('radiation mode')}}</label>
                  <div class="right-info Fill">{{this.prePortalRaditionMode}}</div>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('Delta(cm)')}}</label>
                  <div class="right-info Fill">{{this.prePortalDelta}}</div>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('Open MU')}}</label>
                  <div class="right-info Fill">{{this.prePortalOpenmu}}</div>
                </div>
              </div>
            </div>
            <label class="common-label-title" *ngIf="isImageAble && isDurAble">{{l('Protral During')}}</label>
            <div class="common-bg-container" *ngIf="isImageAble && isDurAble">
              <div class="common-info-row FlexCol">
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label fixed-width-label">MU</label>
                  <div class="right-info Fill">{{this.DuringPortalMu}}</div>
                </div>
              </div>
            </div>
            <label class="common-label-title" *ngIf="isImageAble && isPostAble">{{l('Protral Post')}}</label>
            <div class="common-bg-container" *ngIf="isImageAble && isPostAble">
              <div class="common-info-row FlexCol">
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label fixed-width-label">MU</label>
                  <div class="right-info Fill">{{this.postPortalMu}}</div>
                </div>
              </div>
              <div class="common-info-row FlexCol">
                <div class="common-info-col FlexCol Fill">
                    <label class="form-label-checkbox" [(nzChecked)]="postPortalDoubleExposure" nz-checkbox disabled>{{l('double exposure')}}</label>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('radiation mode')}}</label>
                  <div class="right-info Fill">{{this.postPortalRaditionMode}}</div>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('Delta(cm)')}}</label>
                  <div class="right-info Fill">{{this.postPortalDelta}}</div>
                </div>
                <div class="common-info-col FlexCol Fill">
                  <label class="left-label">{{l('Open MU')}}</label>
                  <div class="right-info Fill">{{this.postPortalOpenmu}}</div>
                </div>
              </div>
            </div>
          </nz-collapse-panel>
        </nz-collapse>
      </div>
      <div class="common-info-li">
        <nz-collapse [nzBordered]="false">
          <nz-collapse-panel nzHeader="{{l('Wedge sequence')}}" [nzActive]="WedgeSequence!=null && WedgeSequence?.Length>0">
            <div class="common-content-box FlexRow">
              <div class="flex-table-div">
                <nz-table tableResizable #WedgeSequenceTable [nzData]="WedgeSequence" nzShowPagination="false"
                  [nzNoResult]="l('No Data')">
                  <thead>
                    <tr>
                      <th>{{l('NO.')}}</th>
                      <th>{{l('wedge type')}}</th>
                      <th>{{l('wedge id')}}</th>
                      <th>{{l('Accessory Code')}}</th>
                      <th>{{l('wedge angle(°)')}}</th>
                      <th>{{l('wedge orientation')}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of WedgeSequence">
                      <td>
                        <span>{{item.wedgeNumber}}</span>
                      </td>
                      <td>
                        <span>{{item.wedgeType}}</span>
                      </td>
                      <td>
                        <span>{{item.wedgeID}}</span>
                      </td>
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{item.wedgeAngle}}</span>
                      </td>
                      <td>
                        <span>{{item.wedgeOrientation}}</span>
                      </td>
                    </tr>
                  </tbody>
                </nz-table>
              </div>
            </div>
          </nz-collapse-panel>
        </nz-collapse>
      </div>
      <div class="common-info-li">
        <nz-collapse [nzBordered]="false">
          <nz-collapse-panel nzHeader="{{l('Bolus sequence')}}" [nzActive]="Bolus!=null && Bolus?.Length>0">
            <div class="common-content-box FlexRow">
              <div class="flex-table-div">
                <nz-table tableResizable #BolusSequenceTable [nzData]="Bolus" nzShowPagination="false"
                  [nzNoResult]="l('No Data')">
                  <thead>
                    <tr>
                      <th>{{l('NO.')}}</th>
                      <th>{{l('referenced ROI NO.')}}</th>
                      <th>{{l('bolus id')}}</th>
                      <th>{{l('bolus description')}}</th>
                      <th>{{l('Accessory Code')}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let bolus of Bolus">
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{bolus.controls.referencedroinumber.value}}</span>
                      </td>
                      <td>
                        <span>{{bolus.controls.bolusid.value}}</span>
                      </td>
                      <td>
                        <span>{{bolus.controls.bolusdescription.value}}</span>
                      </td>
                      <td>
                        <span>{{bolus.controls.accessorycode.value}}</span>
                      </td>
                    </tr>
                  </tbody>
                </nz-table>
              </div>
            </div>
          </nz-collapse-panel>
        </nz-collapse>
      </div>
      <div class="common-info-li">
        <nz-collapse [nzBordered]="false">
          <nz-collapse-panel nzHeader="{{l('Block sequence')}}" [nzActive]="BlockSequence!=null && BlockSequence?.Length>0">

            <div class="common-content-box FlexRow">
              <div class="flex-table-div">
                <nz-table tableResizable #BlockSequenceTable [nzData]="BlockSequence" nzShowPagination="false"
                  [nzNoResult]="l('No Data')">
                  <thead>
                    <tr>
                      <th>{{l('NO.')}}</th>
                      <th>{{l('Block Tray Factor')}}</th>
                      <th>{{l('Block name')}}</th>
                      <th>{{l('Material ID')}}</th>
                      <th>{{l('Block Type')}}</th>
                      <th>{{l('block thickness')}}</th>
                      <th>{{l('Accessory Code')}}</th>
                      <th>{{l('block transmission')}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let block of BlockSequence">
                      <td>
                        <span>{{block.blockNumber}}</span>
                      </td>
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{block.blockName}}</span>
                      </td>
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{block.blockType}}</span>
                      </td>
                      <td>
                        <span>{{block.blockThickness}}</span>
                      </td>
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{block.blockTransmission}}</span>
                      </td>
                    </tr>
                  </tbody>
                </nz-table>
              </div>
            </div>
          </nz-collapse-panel>
        </nz-collapse>
      </div>
      <div class="common-info-li">
        <nz-collapse [nzBordered]="false">
          <nz-collapse-panel nzHeader="{{l('Applicator sequence')}}" [nzActive]="ApplicatorSequence!=null && ApplicatorSequence?.Length>0">
            <div class="common-content-box FlexRow">
              <div class="flex-table-div">
                <nz-table tableResizable #ApplicatorSequenceTable [nzData]="ApplicatorSequence"
                  nzShowPagination="false" [nzNoResult]="l('No Data')">
                  <thead>
                    <tr>
                      <th>Id</th>
                      <th>{{l('Accessory Code')}}</th>
                      <th>{{l('Applicator type')}}</th>
                      <th>{{l('Applicator Aperture Shape')}}</th>
                      <th>{{l('Applicator Opening')}}</th>
                      <th>{{l('Applicator Opening X')}}</th>
                      <th>{{l('Applicator Opening Y')}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let applicator of ApplicatorSequence">
                      <td>
                        <span></span>
                      </td>
                      <td>
                        <span>{{applicator.controls.applicatorId.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.accessoryCode.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.applicatorType.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.apertureShape.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.opening.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.opening_x.value}}</span>
                      </td>
                      <td>
                        <span>{{applicator.controls.opening_y.value}}</span>
                      </td>
                    </tr>
                  </tbody>
                </nz-table>
              </div>
            </div>
          </nz-collapse-panel>
        </nz-collapse>
      </div>
    </div>
  </div>
</div>
